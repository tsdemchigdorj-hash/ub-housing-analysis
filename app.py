import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt

# –í—ç–±–∏–π–Ω –≥–∞—Ä—á–∏–≥
st.title("üèôÔ∏è –£–ª–∞–∞–Ω–±–∞–∞—Ç–∞—Ä —Ö–æ—Ç—ã–Ω –æ—Ä–æ–Ω —Å—É—É—Ü–Ω—ã “Ø–Ω–∏–π–Ω —à–∏–Ω–∂–∏–ª–≥—ç—ç")

# ”®–≥”©–≥–¥–ª–∏–π–≥ —É–Ω—à–∏—Ö (–§–∞–π–ª—ã–Ω –Ω—ç—Ä —è–≥ —Ç–∞–≥ —Ç–∞–∞—Ä–∞—Ö —ë—Å—Ç–æ–π)
@st.cache_data
def load_data():
    # 'cp1251' –Ω—å –∫—Ä–∏–ª–ª “Ø—Å–≥–∏–π–≥ —É–Ω—à–∏—Ö–∞–¥ —Ö–∞–º–≥–∏–π–Ω —Ç“Ø–≥—ç—ç–º—ç–ª –∞—à–∏–≥–ª–∞–≥–¥–¥–∞–≥ –∫–æ–¥ —é–º
    return pd.read_csv('ub_housing.csv', encoding='unicode_escape')

try:
    df = load_data()
    st.success("”®–≥”©–≥–¥–ª–∏–π–≥ –∞–º–∂–∏–ª—Ç—Ç–∞–π —É–Ω—à–ª–∞–∞!")
    
    # –≠–Ω–¥ ”©–º–Ω”© –Ω—å –±–∏—á—Å—ç–Ω –±“Ø—Ö –≥—Ä–∞—Ñ–∏–∫ –∑—É—Ä–∞—Ö –∫–æ–¥—É—É–¥–∞–∞ (pivot_df –≥—ç—Ö –º—ç—Ç) “Ø—Ä–≥—ç–ª–∂–ª“Ø“Ø–ª—ç–Ω –±–∏—á–Ω—ç
    # –ñ–∏—à—ç—ç –Ω—å:
    pivot_df = df.pivot_table(index='–°–∞—Ä', columns='–î“Ø“Ø—Ä—ç–≥', values='–£—Ç–≥–∞', aggfunc='mean')
    st.line_chart(pivot_df) # –≠–Ω–≥–∏–π–Ω —Ö—É—Ä–¥–∞–Ω –≥—Ä–∞—Ñ–∏–∫ —Ö–∞—Ä–∞—Ö—ã–Ω —Ç—É–ª–¥
    
except Exception as e:
    st.error(f"–ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞: {e}")
